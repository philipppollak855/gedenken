{% extends "admin/base_site.html" %}
{% load static settings_tags %}

{# Dieser Block fügt zusätzlichen Inhalt in den <head> der Admin-Seite ein #}
{% block extrahead %}
    {# Lädt den ursprünglichen Inhalt dieses Blocks, inklusive der Unfold-Stylesheets #}
    {{ block.super }}

    {# Font Awesome für Dashboard-Icons #}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    {# Lädt die globalen Einstellungen aus der Datenbank #}
    {% get_site_settings as site_settings %}
    {% if site_settings %}
    
    <!-- Google Fonts für die im Admin auswählbaren Schriftarten -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato&family=Montserrat&family=Open+Sans&family=Roboto&family=Source+Sans+Pro&display=swap" rel="stylesheet">

    <!-- Dynamisches CSS basierend auf den Admin-Einstellungen -->
    <style>
        :root {
            --admin-font-family: {{ site_settings.font_family|safe }};
            --admin-font-size-base: {{ site_settings.font_size_base|safe }};
        }
    </style>
    {% endif %}
    
    {# NEU: Lädt unsere benutzerdefinierte CSS-Datei NACH allen anderen Stylesheets #}
    <link rel="stylesheet" type="text/css" href="{% static 'admin/css/custom_admin.css' %}">
    {# HINZUGEFÜGT: Direkte CSS-Regeln für das verschachtelte Sidebar-Menü #}
    <style>
        /* Stil für das Untermenü-Panel */
        .main-sidebar .nav-sidebar .nav-treeview {
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            margin: 0.5rem 0.5rem 0.5rem 1rem; /* Leichte Einrückung links */
            padding: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
            /* Animations-Setup */
            max-height: 0;
            opacity: 0;
            visibility: hidden;
            overflow: hidden;
            transition: all 0.3s ease-in-out;
        }

        /* Wenn das Menü geöffnet ist (Klasse .menu-open am .nav-item) */
        .main-sidebar .nav-sidebar .nav-item.menu-open > .nav-treeview {
            max-height: 500px; /* Genug Platz für die Items */
            opacity: 1;
            visibility: visible;
        }
        
        /* Pfeil-Animation */
        .main-sidebar .nav-sidebar .nav-link > .right {
            transition: transform 0.3s ease;
        }
        
        .main-sidebar .nav-item.menu-open > .nav-link > .right {
            transform: rotate(-90deg);
        }
    </style>
    
    {# Lädt den ursprünglichen Inhalt dieses Blocks #}
    {{ block.super }}
{% endblock %}

